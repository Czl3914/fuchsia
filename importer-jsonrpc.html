<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Asciidoctor 0.1.4">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Import JSONRPC</title>
<style>
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect2">
<h3 id="_import_jsonrpc">Import JSONRPC</h3>
<div class="sect3">
<h4 id="_goal">Goal</h4>
<div class="paragraph">
<p>Materialise an a remote JSONRPC service instance (available through a URL) into the current OSGi platform.</p>
</div>
</div>
<div class="sect3">
<h4 id="_requirements">Requirements</h4>
<div class="ulist">
<ul>
<li>
<p>URL of the JSONRPC object to be imported</p>
</li>
<li>
<p>declaration containing the metadata below:</p>
<div class="ulist">
<ul>
<li>
<p><strong>id</strong> - a platform unique identifier</p>
</li>
<li>
<p><strong>url</strong> - URL where the object was published. e.g. <a href="http://localhost:8080/JSONRPC/DummyPojoInstance">http://localhost:8080/JSONRPC/DummyPojoInstance</a></p>
</li>
<li>
<p><strong>service.class</strong> - full class identifier used as interface, this reference will be used to register in OSGi. e.g. org.ow2.chameleon.fuchsia.examples.jsonrpc.exporter.experiment.DummyIface</p>
</li>
<li>
<p><strong>configs</strong> - this is a constant, always set with the value <strong>jsonrpc</strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_example">Example</h4>
<div class="sect4">
<h5 id="_importer_instantiation">Importer instantiation</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">     Instance jsonRPCImporter = instance()
            .of("Fuchsia-Importer:JSON-RPC")
            .with(ImporterService.TARGET_FILTER_PROPERTY).setto("(configs=jsonrpc)");</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_linker_instantiation">Linker instantiation</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">        Instance jsonRPCImporterLinker = instance()
            .of(FuchsiaConstants.DEFAULT_IMPORTATION_LINKER_FACTORY_NAME)
            .with(FILTER_IMPORTDECLARATION_PROPERTY).setto("(configs=jsonrpc)")
            .with(FILTER_IMPORTERSERVICE_PROPERTY).setto("(instance.name=jsonRPCImporter)");</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_importer_declaration_instantiation">Importer Declaration instantiation</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="java language-java">        Map&lt;String, Object&gt; metadata=new HashMap&lt;String, Object&gt;();
        metadata.put(ID, "endipoint");
        metadata.put(URL, "http://localhost:8080/JSONRPC/DummyPojoInstance");
        metadata.put(SERVICE_CLASS, "org.ow2.chameleon.fuchsia.examples.jsonrpc.exporter.experiment.DummyIface");
        metadata.put(CONFIGS, "jsonrpc");

        ImportDeclaration declaration = ImportDeclarationBuilder.fromMetadata(metadata).build();

        String clazzes[] = new String[]{ImportDeclaration.class.getName()};

        Dictionary&lt;String, Object&gt; props = new Hashtable&lt;String, Object&gt;();

        ServiceRegistration registration = context.registerService(clazzes, declaration, props);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_verification">Verification</h4>
<div class="sect4">
<h5 id="_service_was_properly_imported">Service was properly imported</h5>
<div class="paragraph">
<p>You can use <strong>felix shelbie shell</strong> and inspect the importer bundle to check if it has correcly imported our JSONRPC remote instance</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="xml language-xml">shelbie-shell$ lb
..
   31|Active     |    1|OW2 Chameleon - Fuchsia Importer JSON-RPC (0.0.2.SNAPSHOT)
..
shelbie-shell$ inspect cap service 31
...
service; org.ow2.chameleon.fuchsia.examples.jsonrpc.exporter.experiment.DummyIface with properties:
   service.id = 693
</code></pre>
</div>
</div>
<div class="paragraph">
<p>Importer should provide a service with the interface that we&#8217;d configured just before in the <strong>Importer Declaration instantiation</strong>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2014-02-06 16:44:48 CET
</div>
</div>
</body>
</html>